/*
USP_LEADUSER_PROFILE_GET(IN lead_index varchar(50))
USP_LEADUSER_PROFILE_UPDATE(IN lead_index varchar(50), IN js_content MEDIUMTEXT)
CALL USP_LEADUSER_PROFILE_GET ( 'fef29532-a487-11ef-99ce-0af7a01f52e9' );
SELECT *
  FROM JSON_table (@js, "$[*]" COLUMNS(
	`Id` varchar(50) PATH '$.id',
	OrderId INT PATH '$.orderId',
	UserId varchar(50) PATH '$.userId',
	ProfileId varchar(50) PATH '$.profileId',
	ProfileGroup varchar(75) PATH '$.profileGroup',
	KeyName varchar(256) PATH '$.keyName',
	KeyValue varchar(256) PATH '$.keyValue'
  ))jt
*/
SET @leadId = 'fef29532-a487-11ef-99ce-0af7a01f52e9';
SET @js = '[{"id": "c5a8b480-b934-4670-b82f-dc39c52d94ea", "userId": "fef29532-a487-11ef-99ce-0af7a01f52e9", "keyName": "First Name", "orderId": 0, "keyValue": null, "profileId": null, "profileGroup": "Name"}, {"id": "ee7fbccb-88a4-4ff0-94d8-a70d467acd02", "userId": "fef29532-a487-11ef-99ce-0af7a01f52e9", "keyName": "Last Name", "orderId": 1, "keyValue": null, "profileId": null, "profileGroup": "Name"}, {"id": "53656b1a-e182-47f4-b5c2-dd7770519bfc", "userId": "fef29532-a487-11ef-99ce-0af7a01f52e9", "keyName": "Company Name", "orderId": 2, "keyValue": null, "profileId": null, "profileGroup": "Name"}, {"id": "af8ced10-a8c1-41d3-a06b-3e0cd5b8f2bb", "userId": "fef29532-a487-11ef-99ce-0af7a01f52e9", "keyName": "Phone 1", "orderId": 3, "keyValue": null, "profileId": null, "profileGroup": "Phone"}, {"id": "ab668cb8-d3ee-4901-8eb1-856a5e3cb3af", "userId": "fef29532-a487-11ef-99ce-0af7a01f52e9", "keyName": "Phone 2", "orderId": 4, "keyValue": null, "profileId": null, "profileGroup": "Phone"}, {"id": "ae94cf64-d5d2-45cf-ac79-a2c0b08bbbfd", "userId": "fef29532-a487-11ef-99ce-0af7a01f52e9", "keyName": "Phone 3", "orderId": 5, "keyValue": null, "profileId": null, "profileGroup": "Phone"}, {"id": "892ff32c-8b95-4881-9d6f-d06b3a2ead96", "userId": "fef29532-a487-11ef-99ce-0af7a01f52e9", "keyName": "Primary Email:", "orderId": 6, "keyValue": null, "profileId": null, "profileGroup": "Email"}, {"id": "77e6b0f4-2bb9-4678-9be0-dd90d525fcc1", "userId": "fef29532-a487-11ef-99ce-0af7a01f52e9", "keyName": "Alternate Email 1:", "orderId": 7, "keyValue": null, "profileId": null, "profileGroup": "Email"}, {"id": "8ccf9777-bb8e-4a61-92f1-e5f961905de1", "userId": "fef29532-a487-11ef-99ce-0af7a01f52e9", "keyName": "Alternate Email 2:", "orderId": 8, "keyValue": null, "profileId": null, "profileGroup": "Email"}, {"id": "0ec220c6-b52a-40f9-851f-f14bbd2f4181", "userId": "fef29532-a487-11ef-99ce-0af7a01f52e9", "keyName": "Mailing Address: Line 1", "orderId": 9, "keyValue": null, "profileId": null, "profileGroup": "Address (Primary)"}, {"id": "fbc27205-a008-4659-93db-adfdd2cc7eab", "userId": "fef29532-a487-11ef-99ce-0af7a01f52e9", "keyName": "Mailing Address: Line 2", "orderId": 10, "keyValue": null, "profileId": null, "profileGroup": "Address (Primary)"}, {"id": "956fa7ea-155a-4c46-981f-edc0dd608c6b", "userId": "fef29532-a487-11ef-99ce-0af7a01f52e9", "keyName": "Mailing Address: Line 3", "orderId": 11, "keyValue": null, "profileId": null, "profileGroup": "Address (Primary)"}, {"id": "30f320fb-5b81-4b70-a729-7fa2523da2da", "userId": "fef29532-a487-11ef-99ce-0af7a01f52e9", "keyName": "Mailing Address: Line 4", "orderId": 12, "keyValue": null, "profileId": null, "profileGroup": "Address (Primary)"}, {"id": "4ce200a1-cb42-4170-90cd-0534120ce06c", "userId": "fef29532-a487-11ef-99ce-0af7a01f52e9", "keyName": "Business Address: Line 1", "orderId": 13, "keyValue": null, "profileId": null, "profileGroup": "Address (Secondary)"}, {"id": "3ee6edbb-09df-4dfa-a2c0-259649cc8ca4", "userId": "fef29532-a487-11ef-99ce-0af7a01f52e9", "keyName": "Business Address: Line 2", "orderId": 14, "keyValue": null, "profileId": null, "profileGroup": "Address (Secondary)"}, {"id": "d2882457-6eee-4f86-acca-c715e0802c57", "userId": "fef29532-a487-11ef-99ce-0af7a01f52e9", "keyName": "Business Address: Line 3", "orderId": 15, "keyValue": null, "profileId": null, "profileGroup": "Address (Secondary)"}, {"id": "31c685ac-d868-4e6a-9f9f-0e3fe63f7a64", "userId": "fef29532-a487-11ef-99ce-0af7a01f52e9", "keyName": "Business Address: Line 4", "orderId": 16, "keyValue": null, "profileId": null, "profileGroup": "Address (Secondary)"}]';
SET SQL_SAFE_UPDATES = 0;
-- CALL USP_LEADUSER_PROFILE_UPDATE( @leadId, @js );
CALL USP_LEADUSER_PROFILE_GET ( 'fef29532-a487-11ef-99ce-0af7a01f52e9' );