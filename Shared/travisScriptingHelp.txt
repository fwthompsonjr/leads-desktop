~ select search by case
var colinput = Array.prototype.slice.call( document.getElementsByTagName('input'), 0 );

var colstatus = colinput.filter(x => { 
let attr = x.getAttribute('name'); 
if ( attr == null ) { return false; } 
return attr == 'CaseStatusType' });

colinput = colinput.filter(x => { 
let attr = x.getAttribute('name'); 
if ( attr == null ) { return false; } 
return attr == 'SearchBy' });
colinput[0].click();
colstatus[1].click();

~ set start and end date
dteStart = '{0}';
dteEnding = '{1}';
searchParm = '{2}';
tboxes = [ 'CaseSearchValue', 'DateFiledOnAfter', 'DateFiledOnBefore' ];
document.getElementById(tboxes[0]).value = searchParm;
document.getElementById(tboxes[1]).value = dteStart;
document.getElementById(tboxes[2]).value = dteEnding;
tboxes.forEach(t => document.getElementById(t).dispatchEvent(new Event('change')))


~ click search
document.getElementById('SearchSubmit').click();

~ get case list
var tables = Array.prototype.slice.call( document.getElementsByTagName('table'), 0);
if (tables.length < 6) return "";
return tables[5].outerHTML;

~ get name and address
var obj = {
	"defendant": "",
	"address": ""
};
var nospace = "&nbsp;"
var linbreak = "<br>";
var twopipe = "||";
var headers = Array.prototype.slice.call( document.getElementsByTagName('th'), 0);
headers = headers.filter(a => { 
  let attr = a.getAttribute('rowspan'); 
  if (attr == null) { return false; } 
  return attr == '2' });
if (headers.length == 0) return JSON.stringify(obj);
var rw = headers[0].closest('tr');
var rwindex = rw.rowIndex + 1;
var addr = rw.closest('table').rows[rwindex].getElementsByTagName('td')[0].innerHTML.trim();
while (addr.indexOf(nospace) >= 0) { addr = addr.replace(nospace, ' '); }
while (addr.indexOf(linbreak) >= 0) { addr = addr.replace(linbreak, '|'); }
while (addr.indexOf(twopipe) >= 0) { addr = addr.replace(twopipe, '|'); }
addr = addr.trim();
obj.defendant = rw.getElementsByTagName('th')[1].innerText;
return JSON.stringify(obj);

~ login process 01
var bttn = document.getElementById('dropdownMenu1');
var parentDiv = bttn.closest('div');
var ul = parentDiv.getElementsByTagName('ul')[0];
var li = ul.getElementsByTagName('li')
var lastLi = li.length - 1;
var link = li[lastLi].children[0]
bttn.click();
link.click();

~ login process 02
var uid = '{0}'
var pwd = '{1}'
var userBox = document.getElementById('UserName');
var wordBox = document.getElementById('Password');
var chekBox = document.getElementById('TOSCheckBox');
var signin = document.getElementById('btnSignIn');
userBox.value = uid;
wordBox.value = pwd;
chekBox.click();
while (signin.getAttribute('disabled') !== null ) { chekBox.click(); }
signin.click();

~ end of file
